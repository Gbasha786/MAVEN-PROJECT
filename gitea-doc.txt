#!/bin/bash
podman pod create --name gitea --publish 3000:3000
##Create a postgres container, give it the desired environment variables, attach it to the created pod
podman run -dt \
    --pod gitea \
    --name gitea-postgres \
    -e POSTGRES_DB=gitea \
    -e POSTGRES_USER=gitea \
    -e POSTGRES_PASSWORD=gitea \
    -e PGDATA=/var/lib/postgresql/data/pgdata \
    -v /home/anas/gitea/postgres:/var/lib/postgresql/data \
    postgres
##Create a keycloak container, give it the desired environment variables, importantly DB_VENDOR, attach it to the created pod
podman run -dt \
    --pod gitea \
    --name gitea-app \
    -e USER_UID=1000 \
    -e USER_GID=1000 \
    -e GITEA__database__DB_TYPE=postgres \
    -e GITEA__database__HOST=localhost:5432 \
    -e GITEA__database__NAME=gitea \
    -e GITEA__database__USER=gitea \
    -e GITEA__database__PASSWD=gitea \
    -v /home/anas/gitea/gitea-data:/data \
    gitea/gitea
